## 🎯 Общее описание
Жора - это голосовой помощник для NixOS с Hyprland, который позволяет управлять рабочими столами и приложениями с помощью голосовых команд. Основные возможности:

1. Определение речи через Silero VAD
2. Распознавание текста через Яндекс SpeechKit
3. Режим диктовки текста
4. Управление окнами и рабочими столами Hyprland

## 🏗️ Архитектура системы

### Компоненты:

1. **VoiceDetector (detector.py)**
   - Использует Silero VAD для определения речи
   - Работает с фиксированной частотой 16кГц
   - Анализирует чанки по 512 сэмплов
   - Возвращает булево значение наличия речи

2. **SpeechRecognizer (recognizer.py)**
   - Записывает аудио пока детектор слышит речь
   - Останавливается после 0.5 сек тишины
   - Конвертирует WAV в OGG для отправки
   - Использует Яндекс STT для распознавания

3. **StreamRecognizer (stream_recognizer.py)**
   - Реализует потоковое распознавание для режима диктовки
   - Использует gRPC для связи с Яндекс STT
   - Эмулирует набор текста через wtype
   - Поддерживает буферизацию для улучшения качества

4. **CommandProcessor (commands.py)**
   - Обрабатывает распознанный текст
   - Выполняет соответствующие команды через hyprctl
   - Поддерживает разные формы слов (склонения)
   - Управляет режимом диктовки

### Процесс работы:

1. **Инициализация:**
   ```mermaid
   graph TD
      A[Старт] --> B[Проверка окружения]
      B --> C[Инициализация детектора]
      C --> D[Инициализация распознавателя]
      D --> E[Инициализация команд]
      E --> F[Основной цикл]
   ```

2. **Основной цикл:**
   ```mermaid
   graph TD
      A[Проверка речи] --> B{Есть речь?}
      B -->|Да| C[Запись аудио]
      C --> D[Распознавание]
      D --> E[Обработка команды]
      E --> A
      B -->|Нет| A
   ```

## 🛠️ Технические детали

### Зависимости:
- Python 3.x
- PyAudio + portaudio
- Silero VAD + torch
- sounddevice
- Яндекс SpeechKit
- opusTools
- grpcio-tools

### Переменные окружения:
```bash
YANDEX_FOLDER_ID=...    # ID каталога в Яндекс Облаке
YANDEX_OAUTH_TOKEN=...  # OAuth токен Яндекса
YANDEX_API_KEY=...      # API ключ для SpeechKit
```

## 📝 Сценарии использования

### Базовые команды:
```bash
"записывай"            # Включить режим диктовки
"завершить запись"     # Выключить режим диктовки
"закрыть"              # Закрыть активное окно
```

### Управление рабочими столами:
```bash
"5"                    # Переход на 5-й рабочий стол
"8"                    # Переход на 8-й рабочий стол
```

### Scratchpad приложения:
```bash
"телеграм"             # Открыть Telegram в scratchpad
"8 телеграм"           # Перейти на 8-й стол и открыть Telegram
"консоль"              # Открыть терминал в scratchpad
"процессы"             # Открыть монитор системы
```

### Приложения на фиксированных столах:
```bash
"редактор"             # Перейти на 3-й стол и открыть редактор
"5 редактор"           # Открыть редактор на 5-м столе
"браузер"              # Перейти на 4-й стол и открыть браузер
```

### Примеры команд:
```bash
"телеграм на 8"        # -> переход на 8-й стол + телеграм
"редактор на 5"        # -> новый редактор на 5-м столе
"консоль на 3"         # -> терминал на 3-м столе
"закрыть"              # -> закрыть активное окно
